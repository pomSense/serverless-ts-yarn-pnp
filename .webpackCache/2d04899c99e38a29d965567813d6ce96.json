{"ast":null,"code":"\"use strict\";\n\n/**\n * DynamoDB Toolbox: A simple set of tools for working with Amazon DynamoDB\n * @author Jeremy Daly <jeremy@jeremydaly.com>\n * @license MIT\n */\nvar __rest = undefined && undefined.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nvar __importDefault = undefined && undefined.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.parseEntity = void 0;\n// Import libraries & types\nconst parseEntityAttributes_1 = __importDefault(require(\"./parseEntityAttributes\"));\n// Import error handlers\nconst utils_1 = require(\"./utils\");\n// Parse entity\nfunction parseEntity(entity) {\n  let {\n      name,\n      timestamps,\n      created,\n      createdAlias,\n      modified,\n      modifiedAlias,\n      typeAlias,\n      attributes,\n      autoExecute,\n      autoParse,\n      table\n    } = entity,\n    args = __rest(entity\n    // TODO: verify string types (e.g. created)\n    // Error on extraneous arguments\n    , [\"name\", \"timestamps\", \"created\", \"createdAlias\", \"modified\", \"modifiedAlias\", \"typeAlias\", \"attributes\", \"autoExecute\", \"autoParse\", \"table\"]) // extraneous config\n  ;\n  // TODO: verify string types (e.g. created)\n  // Error on extraneous arguments\n  if (Object.keys(args).length > 0) utils_1.error(`Invalid Entity configuration options: ${Object.keys(args).join(', ')}`);\n  // Entity name\n  name = typeof name === 'string' && name.trim().length > 0 ? name.trim() : utils_1.error(`'name' must be defined`);\n  // Enable created/modified timestamps on items\n  timestamps = typeof timestamps === 'boolean' ? timestamps : true;\n  // Define 'created' attribute name\n  created = typeof created === 'string' && created.trim().length > 0 ? created.trim() : '_ct';\n  // Define 'createdAlias'\n  createdAlias = typeof createdAlias === 'string' && createdAlias.trim().length > 0 ? createdAlias.trim() : 'created';\n  // Define 'modified' attribute anme\n  modified = typeof modified === 'string' && modified.trim().length > 0 ? modified.trim() : '_md';\n  // Define 'modifiedAlias'\n  modifiedAlias = typeof modifiedAlias === 'string' && modifiedAlias.trim().length > 0 ? modifiedAlias.trim() : 'modified';\n  // Define 'entityAlias'\n  typeAlias = typeof typeAlias === 'string' && typeAlias.trim().length > 0 ? typeAlias.trim() : 'entity';\n  // Sanity check the attributes\n  attributes = typeof attributes === 'object' && !Array.isArray(attributes) ? attributes : utils_1.error(`Please provide a valid 'attributes' object`);\n  // Add timestamps\n  if (timestamps) {\n    attributes[created] = {\n      type: 'string',\n      alias: createdAlias,\n      default: () => new Date().toISOString()\n    };\n    attributes[modified] = {\n      type: 'string',\n      alias: modifiedAlias,\n      default: () => new Date().toISOString(),\n      onUpdate: true\n    };\n  }\n  // Tracking info\n  let track = {\n    fields: Object.keys(attributes),\n    defaults: {},\n    required: {},\n    linked: {},\n    keys: {} // tracks partition/sort/index keys\n  };\n  // Return the entity\n  return Object.assign({\n    name,\n    schema: parseEntityAttributes_1.default(attributes, track),\n    defaults: track.defaults,\n    required: track.required,\n    linked: track.linked,\n    autoExecute,\n    autoParse,\n    _etAlias: typeAlias\n  }, table ? {\n    table\n  } : {}); // end mapping object\n} // end parseEntity\nexports.parseEntity = parseEntity;\nexports.default = parseEntity;","map":{"version":3,"names":["__rest","undefined","s","e","t","p","Object","prototype","hasOwnProperty","call","indexOf","getOwnPropertySymbols","i","length","propertyIsEnumerable","__importDefault","mod","__esModule","defineProperty","exports","value","parseEntity","parseEntityAttributes_1","require","utils_1","entity","name","timestamps","created","createdAlias","modified","modifiedAlias","typeAlias","attributes","autoExecute","autoParse","table","args","keys","error","join","trim","Array","isArray","type","alias","default","Date","toISOString","onUpdate","track","fields","defaults","required","linked","assign","schema","_etAlias"],"sources":["/Users/pom/Code/serverless-ts-yarn-pnp/.yarn/cache/dynamodb-toolbox-npm-0.3.5-3ff4bf5328-d75542b529.zip/node_modules/dynamodb-toolbox/dist/lib/parseEntity.js"],"sourcesContent":["\"use strict\";\n/**\n * DynamoDB Toolbox: A simple set of tools for working with Amazon DynamoDB\n * @author Jeremy Daly <jeremy@jeremydaly.com>\n * @license MIT\n */\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.parseEntity = void 0;\n// Import libraries & types\nconst parseEntityAttributes_1 = __importDefault(require(\"./parseEntityAttributes\"));\n// Import error handlers\nconst utils_1 = require(\"./utils\");\n// Parse entity\nfunction parseEntity(entity) {\n    let { name, timestamps, created, createdAlias, modified, modifiedAlias, typeAlias, attributes, autoExecute, autoParse, table } = entity, args = __rest(entity\n    // TODO: verify string types (e.g. created)\n    // Error on extraneous arguments\n    , [\"name\", \"timestamps\", \"created\", \"createdAlias\", \"modified\", \"modifiedAlias\", \"typeAlias\", \"attributes\", \"autoExecute\", \"autoParse\", \"table\"]) // extraneous config\n    ;\n    // TODO: verify string types (e.g. created)\n    // Error on extraneous arguments\n    if (Object.keys(args).length > 0)\n        utils_1.error(`Invalid Entity configuration options: ${Object.keys(args).join(', ')}`);\n    // Entity name\n    name = typeof name === 'string'\n        && name.trim().length > 0 ? name.trim()\n        : utils_1.error(`'name' must be defined`);\n    // Enable created/modified timestamps on items\n    timestamps = typeof timestamps === 'boolean' ? timestamps : true;\n    // Define 'created' attribute name\n    created = typeof created === 'string'\n        && created.trim().length > 0 ? created.trim()\n        : '_ct';\n    // Define 'createdAlias'\n    createdAlias = typeof createdAlias === 'string'\n        && createdAlias.trim().length > 0 ? createdAlias.trim()\n        : 'created';\n    // Define 'modified' attribute anme\n    modified = typeof modified === 'string'\n        && modified.trim().length > 0 ? modified.trim()\n        : '_md';\n    // Define 'modifiedAlias'\n    modifiedAlias = typeof modifiedAlias === 'string'\n        && modifiedAlias.trim().length > 0 ? modifiedAlias.trim()\n        : 'modified';\n    // Define 'entityAlias'\n    typeAlias = typeof typeAlias === 'string'\n        && typeAlias.trim().length > 0 ? typeAlias.trim()\n        : 'entity';\n    // Sanity check the attributes\n    attributes = typeof attributes === 'object' && !Array.isArray(attributes) ?\n        attributes : utils_1.error(`Please provide a valid 'attributes' object`);\n    // Add timestamps\n    if (timestamps) {\n        attributes[created] = { type: 'string', alias: createdAlias, default: () => new Date().toISOString() };\n        attributes[modified] = { type: 'string', alias: modifiedAlias, default: () => new Date().toISOString(), onUpdate: true };\n    }\n    // Tracking info\n    let track = {\n        fields: Object.keys(attributes),\n        defaults: {},\n        required: {},\n        linked: {},\n        keys: {} // tracks partition/sort/index keys\n    };\n    // Return the entity\n    return Object.assign({\n        name,\n        schema: parseEntityAttributes_1.default(attributes, track),\n        defaults: track.defaults,\n        required: track.required,\n        linked: track.linked,\n        autoExecute,\n        autoParse,\n        _etAlias: typeAlias\n    }, table ? { table } : {}); // end mapping object\n} // end parseEntity\nexports.parseEntity = parseEntity;\nexports.default = parseEntity;\n"],"mappings":"AAAA,YAAY;;AACZ;AACA;AACA;AACA;AACA;AACA,IAAIA,MAAM,GAAIC,SAAA,IAAQA,SAAA,CAAKD,MAAM,IAAK,UAAUE,CAAC,EAAEC,CAAC,EAAE;EAClD,IAAIC,CAAC,GAAG,CAAC,CAAC;EACV,KAAK,IAAIC,CAAC,IAAIH,CAAC,EAAE,IAAII,MAAM,CAACC,SAAS,CAACC,cAAc,CAACC,IAAI,CAACP,CAAC,EAAEG,CAAC,CAAC,IAAIF,CAAC,CAACO,OAAO,CAACL,CAAC,CAAC,GAAG,CAAC,EAC/ED,CAAC,CAACC,CAAC,CAAC,GAAGH,CAAC,CAACG,CAAC,CAAC;EACf,IAAIH,CAAC,IAAI,IAAI,IAAI,OAAOI,MAAM,CAACK,qBAAqB,KAAK,UAAU,EAC/D,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEP,CAAC,GAAGC,MAAM,CAACK,qBAAqB,CAACT,CAAC,CAAC,EAAEU,CAAC,GAAGP,CAAC,CAACQ,MAAM,EAAED,CAAC,EAAE,EAAE;IACpE,IAAIT,CAAC,CAACO,OAAO,CAACL,CAAC,CAACO,CAAC,CAAC,CAAC,GAAG,CAAC,IAAIN,MAAM,CAACC,SAAS,CAACO,oBAAoB,CAACL,IAAI,CAACP,CAAC,EAAEG,CAAC,CAACO,CAAC,CAAC,CAAC,EAC1ER,CAAC,CAACC,CAAC,CAACO,CAAC,CAAC,CAAC,GAAGV,CAAC,CAACG,CAAC,CAACO,CAAC,CAAC,CAAC;EACzB;EACJ,OAAOR,CAAC;AACZ,CAAC;AACD,IAAIW,eAAe,GAAId,SAAA,IAAQA,SAAA,CAAKc,eAAe,IAAK,UAAUC,GAAG,EAAE;EACnE,OAAQA,GAAG,IAAIA,GAAG,CAACC,UAAU,GAAID,GAAG,GAAG;IAAE,SAAS,EAAEA;EAAI,CAAC;AAC7D,CAAC;AACDV,MAAM,CAACY,cAAc,CAACC,OAAO,EAAE,YAAY,EAAE;EAAEC,KAAK,EAAE;AAAK,CAAC,CAAC;AAC7DD,OAAO,CAACE,WAAW,GAAG,KAAK,CAAC;AAC5B;AACA,MAAMC,uBAAuB,GAAGP,eAAe,CAACQ,OAAO,CAAC,yBAAyB,CAAC,CAAC;AACnF;AACA,MAAMC,OAAO,GAAGD,OAAO,CAAC,SAAS,CAAC;AAClC;AACA,SAASF,WAAWA,CAACI,MAAM,EAAE;EACzB,IAAI;MAAEC,IAAI;MAAEC,UAAU;MAAEC,OAAO;MAAEC,YAAY;MAAEC,QAAQ;MAAEC,aAAa;MAAEC,SAAS;MAAEC,UAAU;MAAEC,WAAW;MAAEC,SAAS;MAAEC;IAAM,CAAC,GAAGX,MAAM;IAAEY,IAAI,GAAGrC,MAAM,CAACyB;IACvJ;IACA;IAAA,EACE,CAAC,MAAM,EAAE,YAAY,EAAE,SAAS,EAAE,cAAc,EAAE,UAAU,EAAE,eAAe,EAAE,WAAW,EAAE,YAAY,EAAE,aAAa,EAAE,WAAW,EAAE,OAAO,CAAC,CAAC,CAAC;EAAA;EAElJ;EACA;EACA,IAAInB,MAAM,CAACgC,IAAI,CAACD,IAAI,CAAC,CAACxB,MAAM,GAAG,CAAC,EAC5BW,OAAO,CAACe,KAAK,CAAE,yCAAwCjC,MAAM,CAACgC,IAAI,CAACD,IAAI,CAAC,CAACG,IAAI,CAAC,IAAI,CAAE,EAAC,CAAC;EAC1F;EACAd,IAAI,GAAG,OAAOA,IAAI,KAAK,QAAQ,IACxBA,IAAI,CAACe,IAAI,CAAC,CAAC,CAAC5B,MAAM,GAAG,CAAC,GAAGa,IAAI,CAACe,IAAI,CAAC,CAAC,GACrCjB,OAAO,CAACe,KAAK,CAAE,wBAAuB,CAAC;EAC7C;EACAZ,UAAU,GAAG,OAAOA,UAAU,KAAK,SAAS,GAAGA,UAAU,GAAG,IAAI;EAChE;EACAC,OAAO,GAAG,OAAOA,OAAO,KAAK,QAAQ,IAC9BA,OAAO,CAACa,IAAI,CAAC,CAAC,CAAC5B,MAAM,GAAG,CAAC,GAAGe,OAAO,CAACa,IAAI,CAAC,CAAC,GAC3C,KAAK;EACX;EACAZ,YAAY,GAAG,OAAOA,YAAY,KAAK,QAAQ,IACxCA,YAAY,CAACY,IAAI,CAAC,CAAC,CAAC5B,MAAM,GAAG,CAAC,GAAGgB,YAAY,CAACY,IAAI,CAAC,CAAC,GACrD,SAAS;EACf;EACAX,QAAQ,GAAG,OAAOA,QAAQ,KAAK,QAAQ,IAChCA,QAAQ,CAACW,IAAI,CAAC,CAAC,CAAC5B,MAAM,GAAG,CAAC,GAAGiB,QAAQ,CAACW,IAAI,CAAC,CAAC,GAC7C,KAAK;EACX;EACAV,aAAa,GAAG,OAAOA,aAAa,KAAK,QAAQ,IAC1CA,aAAa,CAACU,IAAI,CAAC,CAAC,CAAC5B,MAAM,GAAG,CAAC,GAAGkB,aAAa,CAACU,IAAI,CAAC,CAAC,GACvD,UAAU;EAChB;EACAT,SAAS,GAAG,OAAOA,SAAS,KAAK,QAAQ,IAClCA,SAAS,CAACS,IAAI,CAAC,CAAC,CAAC5B,MAAM,GAAG,CAAC,GAAGmB,SAAS,CAACS,IAAI,CAAC,CAAC,GAC/C,QAAQ;EACd;EACAR,UAAU,GAAG,OAAOA,UAAU,KAAK,QAAQ,IAAI,CAACS,KAAK,CAACC,OAAO,CAACV,UAAU,CAAC,GACrEA,UAAU,GAAGT,OAAO,CAACe,KAAK,CAAE,4CAA2C,CAAC;EAC5E;EACA,IAAIZ,UAAU,EAAE;IACZM,UAAU,CAACL,OAAO,CAAC,GAAG;MAAEgB,IAAI,EAAE,QAAQ;MAAEC,KAAK,EAAEhB,YAAY;MAAEiB,OAAO,EAAEA,CAAA,KAAM,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;IAAE,CAAC;IACtGf,UAAU,CAACH,QAAQ,CAAC,GAAG;MAAEc,IAAI,EAAE,QAAQ;MAAEC,KAAK,EAAEd,aAAa;MAAEe,OAAO,EAAEA,CAAA,KAAM,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;MAAEC,QAAQ,EAAE;IAAK,CAAC;EAC5H;EACA;EACA,IAAIC,KAAK,GAAG;IACRC,MAAM,EAAE7C,MAAM,CAACgC,IAAI,CAACL,UAAU,CAAC;IAC/BmB,QAAQ,EAAE,CAAC,CAAC;IACZC,QAAQ,EAAE,CAAC,CAAC;IACZC,MAAM,EAAE,CAAC,CAAC;IACVhB,IAAI,EAAE,CAAC,CAAC,CAAC;EACb,CAAC;EACD;EACA,OAAOhC,MAAM,CAACiD,MAAM,CAAC;IACjB7B,IAAI;IACJ8B,MAAM,EAAElC,uBAAuB,CAACwB,OAAO,CAACb,UAAU,EAAEiB,KAAK,CAAC;IAC1DE,QAAQ,EAAEF,KAAK,CAACE,QAAQ;IACxBC,QAAQ,EAAEH,KAAK,CAACG,QAAQ;IACxBC,MAAM,EAAEJ,KAAK,CAACI,MAAM;IACpBpB,WAAW;IACXC,SAAS;IACTsB,QAAQ,EAAEzB;EACd,CAAC,EAAEI,KAAK,GAAG;IAAEA;EAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;AAChC,CAAC,CAAC;AACFjB,OAAO,CAACE,WAAW,GAAGA,WAAW;AACjCF,OAAO,CAAC2B,OAAO,GAAGzB,WAAW"},"metadata":{},"sourceType":"module"}