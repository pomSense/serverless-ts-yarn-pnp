{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.formatApolloErrors = exports.UserInputError = exports.PersistedQueryNotSupportedError = exports.PersistedQueryNotFoundError = exports.ForbiddenError = exports.AuthenticationError = exports.ValidationError = exports.SyntaxError = exports.fromGraphQLError = exports.toApolloError = exports.ApolloError = void 0;\nconst graphql_1 = require(\"graphql\");\nclass ApolloError extends Error {\n  constructor(message, code, extensions) {\n    super(message);\n    if (!this.name) {\n      Object.defineProperty(this, 'name', {\n        value: 'ApolloError'\n      });\n    }\n    if (extensions === null || extensions === void 0 ? void 0 : extensions.extensions) {\n      throw Error('Pass extensions directly as the third argument of the ApolloError constructor: `new ' + 'ApolloError(message, code, {myExt: value})`, not `new ApolloError(message, code, ' + '{extensions: {myExt: value}})`');\n    }\n    this.extensions = {\n      ...extensions,\n      code\n    };\n  }\n  toJSON() {\n    return (0, graphql_1.formatError)(toGraphQLError(this));\n  }\n  toString() {\n    return (0, graphql_1.printError)(toGraphQLError(this));\n  }\n  get [Symbol.toStringTag]() {\n    return this.name;\n  }\n}\nexports.ApolloError = ApolloError;\nfunction toGraphQLError(error) {\n  return new graphql_1.GraphQLError(error.message, error.nodes, error.source, error.positions, error.path, error.originalError, error.extensions);\n}\nfunction enrichError(error, debug = false) {\n  var _a, _b, _c;\n  const expanded = Object.create(Object.getPrototypeOf(error), {\n    name: {\n      value: error.name\n    },\n    message: {\n      value: error.message,\n      enumerable: true,\n      writable: true\n    },\n    locations: {\n      value: error.locations || undefined,\n      enumerable: true\n    },\n    path: {\n      value: error.path || undefined,\n      enumerable: true\n    },\n    nodes: {\n      value: error.nodes || undefined\n    },\n    source: {\n      value: error.source || undefined\n    },\n    positions: {\n      value: error.positions || undefined\n    },\n    originalError: {\n      value: error.originalError\n    }\n  });\n  expanded.extensions = {\n    ...error.extensions,\n    code: ((_a = error.extensions) === null || _a === void 0 ? void 0 : _a.code) || 'INTERNAL_SERVER_ERROR',\n    exception: {\n      ...((_b = error.extensions) === null || _b === void 0 ? void 0 : _b.exception),\n      ...error.originalError\n    }\n  };\n  delete expanded.extensions.exception.extensions;\n  if (debug && !expanded.extensions.exception.stacktrace) {\n    const stack = ((_c = error.originalError) === null || _c === void 0 ? void 0 : _c.stack) || error.stack;\n    expanded.extensions.exception.stacktrace = stack === null || stack === void 0 ? void 0 : stack.split('\\n');\n  }\n  if (Object.keys(expanded.extensions.exception).length === 0) {\n    delete expanded.extensions.exception;\n  }\n  return expanded;\n}\nfunction toApolloError(error, code = 'INTERNAL_SERVER_ERROR') {\n  let err = error;\n  if (err.extensions) {\n    err.extensions.code = code;\n  } else {\n    err.extensions = {\n      code\n    };\n  }\n  return err;\n}\nexports.toApolloError = toApolloError;\nfunction fromGraphQLError(error, options) {\n  const copy = (options === null || options === void 0 ? void 0 : options.errorClass) ? new options.errorClass(error.message) : new ApolloError(error.message);\n  Object.entries(error).forEach(([key, value]) => {\n    if (key === 'extensions') {\n      return;\n    }\n    copy[key] = value;\n  });\n  copy.extensions = {\n    ...copy.extensions,\n    ...error.extensions\n  };\n  if (!copy.extensions.code) {\n    copy.extensions.code = (options === null || options === void 0 ? void 0 : options.code) || 'INTERNAL_SERVER_ERROR';\n  }\n  Object.defineProperty(copy, 'originalError', {\n    value: {}\n  });\n  Object.getOwnPropertyNames(error).forEach(key => {\n    Object.defineProperty(copy.originalError, key, {\n      value: error[key]\n    });\n  });\n  return copy;\n}\nexports.fromGraphQLError = fromGraphQLError;\nclass SyntaxError extends ApolloError {\n  constructor(message) {\n    super(message, 'GRAPHQL_PARSE_FAILED');\n    Object.defineProperty(this, 'name', {\n      value: 'SyntaxError'\n    });\n  }\n}\nexports.SyntaxError = SyntaxError;\nclass ValidationError extends ApolloError {\n  constructor(message) {\n    super(message, 'GRAPHQL_VALIDATION_FAILED');\n    Object.defineProperty(this, 'name', {\n      value: 'ValidationError'\n    });\n  }\n}\nexports.ValidationError = ValidationError;\nclass AuthenticationError extends ApolloError {\n  constructor(message, extensions) {\n    super(message, 'UNAUTHENTICATED', extensions);\n    Object.defineProperty(this, 'name', {\n      value: 'AuthenticationError'\n    });\n  }\n}\nexports.AuthenticationError = AuthenticationError;\nclass ForbiddenError extends ApolloError {\n  constructor(message, extensions) {\n    super(message, 'FORBIDDEN', extensions);\n    Object.defineProperty(this, 'name', {\n      value: 'ForbiddenError'\n    });\n  }\n}\nexports.ForbiddenError = ForbiddenError;\nclass PersistedQueryNotFoundError extends ApolloError {\n  constructor() {\n    super('PersistedQueryNotFound', 'PERSISTED_QUERY_NOT_FOUND');\n    Object.defineProperty(this, 'name', {\n      value: 'PersistedQueryNotFoundError'\n    });\n  }\n}\nexports.PersistedQueryNotFoundError = PersistedQueryNotFoundError;\nclass PersistedQueryNotSupportedError extends ApolloError {\n  constructor() {\n    super('PersistedQueryNotSupported', 'PERSISTED_QUERY_NOT_SUPPORTED');\n    Object.defineProperty(this, 'name', {\n      value: 'PersistedQueryNotSupportedError'\n    });\n  }\n}\nexports.PersistedQueryNotSupportedError = PersistedQueryNotSupportedError;\nclass UserInputError extends ApolloError {\n  constructor(message, extensions) {\n    super(message, 'BAD_USER_INPUT', extensions);\n    Object.defineProperty(this, 'name', {\n      value: 'UserInputError'\n    });\n  }\n}\nexports.UserInputError = UserInputError;\nfunction formatApolloErrors(errors, options) {\n  if (!options) {\n    return errors.map(error => enrichError(error));\n  }\n  const {\n    formatter,\n    debug\n  } = options;\n  const enrichedErrors = errors.map(error => enrichError(error, debug));\n  const makePrintable = error => {\n    if (error instanceof Error) {\n      const graphQLError = error;\n      return {\n        message: graphQLError.message,\n        ...(graphQLError.locations && {\n          locations: graphQLError.locations\n        }),\n        ...(graphQLError.path && {\n          path: graphQLError.path\n        }),\n        ...(graphQLError.extensions && {\n          extensions: graphQLError.extensions\n        })\n      };\n    }\n    return error;\n  };\n  if (!formatter) {\n    return enrichedErrors;\n  }\n  return enrichedErrors.map(error => {\n    try {\n      return makePrintable(formatter(error));\n    } catch (err) {\n      if (debug) {\n        return enrichError(err, debug);\n      } else {\n        const newError = fromGraphQLError(new graphql_1.GraphQLError('Internal server error'));\n        return enrichError(newError, debug);\n      }\n    }\n  });\n}\nexports.formatApolloErrors = formatApolloErrors;","map":{"version":3,"mappings":"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","names":["graphql_1","require","ApolloError","Error","constructor","message","code","extensions","name","Object","defineProperty","value","toJSON","formatError","toGraphQLError","toString","printError","Symbol","toStringTag","exports","error","GraphQLError","nodes","source","positions","path","originalError","enrichError","debug","expanded","create","getPrototypeOf","enumerable","writable","locations","undefined","_a","exception","_b","stacktrace","stack","_c","split","keys","length","toApolloError","err","fromGraphQLError","options","copy","errorClass","entries","forEach","key","getOwnPropertyNames","SyntaxError","ValidationError","AuthenticationError","ForbiddenError","PersistedQueryNotFoundError","PersistedQueryNotSupportedError","UserInputError","formatApolloErrors","errors","map","formatter","enrichedErrors","makePrintable","graphQLError","newError"],"sourceRoot":"","sources":["../src/index.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"module"}